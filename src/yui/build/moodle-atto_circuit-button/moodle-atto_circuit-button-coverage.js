
var __cov_RLVARTH7R3hs16JuZi1usA = (Function('return this'))();
if (!__cov_RLVARTH7R3hs16JuZi1usA.__coverage__) { __cov_RLVARTH7R3hs16JuZi1usA.__coverage__ = {}; }
__cov_RLVARTH7R3hs16JuZi1usA = __cov_RLVARTH7R3hs16JuZi1usA.__coverage__;
if (!(__cov_RLVARTH7R3hs16JuZi1usA['build/moodle-atto_circuit-button/moodle-atto_circuit-button.js'])) {
   __cov_RLVARTH7R3hs16JuZi1usA['build/moodle-atto_circuit-button/moodle-atto_circuit-button.js'] = {"path":"build/moodle-atto_circuit-button/moodle-atto_circuit-button.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":38},"end":{"line":1,"column":57}}},"2":{"name":"(anonymous_2)","line":80,"loc":{"start":{"line":80,"column":25},"end":{"line":80,"column":36}}},"3":{"name":"(anonymous_3)","line":110,"loc":{"start":{"line":110,"column":27},"end":{"line":110,"column":45}}},"4":{"name":"(anonymous_4)","line":141,"loc":{"start":{"line":141,"column":23},"end":{"line":141,"column":35}}},"5":{"name":"(anonymous_5)","line":201,"loc":{"start":{"line":201,"column":45},"end":{"line":201,"column":56}}},"6":{"name":"(anonymous_6)","line":241,"loc":{"start":{"line":241,"column":72},"end":{"line":241,"column":83}}},"7":{"name":"(anonymous_7)","line":267,"loc":{"start":{"line":267,"column":41},"end":{"line":267,"column":52}}},"8":{"name":"(anonymous_8)","line":321,"loc":{"start":{"line":321,"column":30},"end":{"line":321,"column":55}}},"9":{"name":"(anonymous_9)","line":337,"loc":{"start":{"line":337,"column":48},"end":{"line":337,"column":59}}},"10":{"name":"(anonymous_10)","line":341,"loc":{"start":{"line":341,"column":35},"end":{"line":341,"column":46}}},"11":{"name":"(anonymous_11)","line":424,"loc":{"start":{"line":424,"column":29},"end":{"line":424,"column":51}}},"12":{"name":"(anonymous_12)","line":454,"loc":{"start":{"line":454,"column":29},"end":{"line":454,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":488,"column":61}},"2":{"start":{"line":42,"column":4},"end":{"line":72,"column":20}},"3":{"start":{"line":74,"column":8},"end":{"line":483,"column":12}},"4":{"start":{"line":82,"column":16},"end":{"line":84,"column":17}},"5":{"start":{"line":83,"column":20},"end":{"line":83,"column":27}},"6":{"start":{"line":89,"column":20},"end":{"line":98,"column":23}},"7":{"start":{"line":112,"column":16},"end":{"line":112,"column":31}},"8":{"start":{"line":116,"column":16},"end":{"line":120,"column":17}},"9":{"start":{"line":117,"column":20},"end":{"line":117,"column":61}},"10":{"start":{"line":119,"column":20},"end":{"line":119,"column":66}},"11":{"start":{"line":122,"column":16},"end":{"line":122,"column":83}},"12":{"start":{"line":125,"column":16},"end":{"line":125,"column":59}},"13":{"start":{"line":126,"column":16},"end":{"line":128,"column":17}},"14":{"start":{"line":127,"column":20},"end":{"line":127,"column":53}},"15":{"start":{"line":130,"column":16},"end":{"line":130,"column":58}},"16":{"start":{"line":142,"column":16},"end":{"line":142,"column":35}},"17":{"start":{"line":143,"column":16},"end":{"line":145,"column":67}},"18":{"start":{"line":147,"column":16},"end":{"line":147,"column":37}},"19":{"start":{"line":148,"column":16},"end":{"line":148,"column":29}},"20":{"start":{"line":149,"column":16},"end":{"line":149,"column":107}},"21":{"start":{"line":153,"column":16},"end":{"line":153,"column":74}},"22":{"start":{"line":154,"column":16},"end":{"line":154,"column":42}},"23":{"start":{"line":156,"column":16},"end":{"line":156,"column":114}},"24":{"start":{"line":157,"column":16},"end":{"line":157,"column":49}},"25":{"start":{"line":158,"column":16},"end":{"line":254,"column":17}},"26":{"start":{"line":159,"column":20},"end":{"line":166,"column":65}},"27":{"start":{"line":168,"column":20},"end":{"line":168,"column":39}},"28":{"start":{"line":169,"column":20},"end":{"line":169,"column":40}},"29":{"start":{"line":170,"column":20},"end":{"line":170,"column":70}},"30":{"start":{"line":171,"column":20},"end":{"line":171,"column":62}},"31":{"start":{"line":174,"column":20},"end":{"line":179,"column":21}},"32":{"start":{"line":175,"column":24},"end":{"line":178,"column":25}},"33":{"start":{"line":176,"column":28},"end":{"line":176,"column":89}},"34":{"start":{"line":177,"column":28},"end":{"line":177,"column":34}},"35":{"start":{"line":180,"column":20},"end":{"line":180,"column":56}},"36":{"start":{"line":181,"column":20},"end":{"line":181,"column":62}},"37":{"start":{"line":182,"column":20},"end":{"line":182,"column":68}},"38":{"start":{"line":183,"column":20},"end":{"line":183,"column":58}},"39":{"start":{"line":184,"column":20},"end":{"line":184,"column":66}},"40":{"start":{"line":187,"column":20},"end":{"line":187,"column":53}},"41":{"start":{"line":188,"column":20},"end":{"line":188,"column":101}},"42":{"start":{"line":189,"column":20},"end":{"line":189,"column":68}},"43":{"start":{"line":190,"column":20},"end":{"line":190,"column":33}},"44":{"start":{"line":191,"column":20},"end":{"line":191,"column":44}},"45":{"start":{"line":192,"column":20},"end":{"line":196,"column":23}},"46":{"start":{"line":197,"column":20},"end":{"line":197,"column":62}},"47":{"start":{"line":198,"column":20},"end":{"line":198,"column":39}},"48":{"start":{"line":201,"column":20},"end":{"line":250,"column":22}},"49":{"start":{"line":202,"column":24},"end":{"line":206,"column":37}},"50":{"start":{"line":208,"column":24},"end":{"line":248,"column":25}},"51":{"start":{"line":209,"column":28},"end":{"line":247,"column":29}},"52":{"start":{"line":210,"column":32},"end":{"line":210,"column":70}},"53":{"start":{"line":211,"column":32},"end":{"line":239,"column":33}},"54":{"start":{"line":212,"column":36},"end":{"line":217,"column":37}},"55":{"start":{"line":213,"column":40},"end":{"line":215,"column":41}},"56":{"start":{"line":214,"column":44},"end":{"line":214,"column":69}},"57":{"start":{"line":216,"column":40},"end":{"line":216,"column":80}},"58":{"start":{"line":219,"column":36},"end":{"line":219,"column":50}},"59":{"start":{"line":220,"column":36},"end":{"line":225,"column":37}},"60":{"start":{"line":224,"column":40},"end":{"line":224,"column":62}},"61":{"start":{"line":228,"column":36},"end":{"line":231,"column":39}},"62":{"start":{"line":232,"column":36},"end":{"line":232,"column":70}},"63":{"start":{"line":233,"column":36},"end":{"line":237,"column":37}},"64":{"start":{"line":234,"column":40},"end":{"line":234,"column":70}},"65":{"start":{"line":236,"column":40},"end":{"line":236,"column":74}},"66":{"start":{"line":238,"column":36},"end":{"line":238,"column":55}},"67":{"start":{"line":241,"column":32},"end":{"line":243,"column":35}},"68":{"start":{"line":242,"column":36},"end":{"line":242,"column":108}},"69":{"start":{"line":244,"column":32},"end":{"line":246,"column":33}},"70":{"start":{"line":245,"column":36},"end":{"line":245,"column":61}},"71":{"start":{"line":249,"column":24},"end":{"line":249,"column":36}},"72":{"start":{"line":251,"column":20},"end":{"line":251,"column":108}},"73":{"start":{"line":252,"column":20},"end":{"line":252,"column":39}},"74":{"start":{"line":253,"column":20},"end":{"line":253,"column":32}},"75":{"start":{"line":255,"column":16},"end":{"line":255,"column":28}},"76":{"start":{"line":268,"column":16},"end":{"line":278,"column":23}},"77":{"start":{"line":280,"column":16},"end":{"line":282,"column":17}},"78":{"start":{"line":281,"column":20},"end":{"line":281,"column":50}},"79":{"start":{"line":284,"column":16},"end":{"line":306,"column":17}},"80":{"start":{"line":285,"column":20},"end":{"line":285,"column":57}},"81":{"start":{"line":287,"column":20},"end":{"line":287,"column":70}},"82":{"start":{"line":288,"column":20},"end":{"line":290,"column":21}},"83":{"start":{"line":289,"column":24},"end":{"line":289,"column":52}},"84":{"start":{"line":291,"column":20},"end":{"line":291,"column":72}},"85":{"start":{"line":292,"column":20},"end":{"line":294,"column":21}},"86":{"start":{"line":293,"column":24},"end":{"line":293,"column":54}},"87":{"start":{"line":296,"column":20},"end":{"line":298,"column":21}},"88":{"start":{"line":297,"column":24},"end":{"line":297,"column":49}},"89":{"start":{"line":299,"column":20},"end":{"line":301,"column":21}},"90":{"start":{"line":300,"column":24},"end":{"line":300,"column":51}},"91":{"start":{"line":303,"column":20},"end":{"line":303,"column":77}},"92":{"start":{"line":304,"column":20},"end":{"line":304,"column":83}},"93":{"start":{"line":305,"column":20},"end":{"line":305,"column":38}},"94":{"start":{"line":309,"column":16},"end":{"line":309,"column":43}},"95":{"start":{"line":310,"column":16},"end":{"line":310,"column":29}},"96":{"start":{"line":322,"column":16},"end":{"line":325,"column":29}},"97":{"start":{"line":327,"column":16},"end":{"line":332,"column":19}},"98":{"start":{"line":334,"column":16},"end":{"line":334,"column":35}},"99":{"start":{"line":337,"column":16},"end":{"line":345,"column":19}},"100":{"start":{"line":338,"column":20},"end":{"line":338,"column":57}},"101":{"start":{"line":340,"column":20},"end":{"line":344,"column":21}},"102":{"start":{"line":341,"column":24},"end":{"line":343,"column":30}},"103":{"start":{"line":342,"column":28},"end":{"line":342,"column":45}},"104":{"start":{"line":348,"column":16},"end":{"line":348,"column":64}},"105":{"start":{"line":351,"column":16},"end":{"line":351,"column":57}},"106":{"start":{"line":353,"column":16},"end":{"line":353,"column":61}},"107":{"start":{"line":354,"column":16},"end":{"line":354,"column":42}},"108":{"start":{"line":355,"column":16},"end":{"line":355,"column":32}},"109":{"start":{"line":356,"column":16},"end":{"line":356,"column":35}},"110":{"start":{"line":425,"column":16},"end":{"line":434,"column":24}},"111":{"start":{"line":436,"column":20},"end":{"line":436,"column":41}},"112":{"start":{"line":438,"column":20},"end":{"line":443,"column":21}},"113":{"start":{"line":439,"column":24},"end":{"line":439,"column":96}},"114":{"start":{"line":440,"column":24},"end":{"line":440,"column":48}},"115":{"start":{"line":442,"column":24},"end":{"line":442,"column":102}},"116":{"start":{"line":445,"column":20},"end":{"line":445,"column":35}},"117":{"start":{"line":455,"column":16},"end":{"line":455,"column":35}},"118":{"start":{"line":456,"column":16},"end":{"line":456,"column":34}},"119":{"start":{"line":457,"column":16},"end":{"line":457,"column":107}},"120":{"start":{"line":458,"column":4},"end":{"line":458,"column":35}},"121":{"start":{"line":461,"column":20},"end":{"line":461,"column":64}},"122":{"start":{"line":465,"column":16},"end":{"line":465,"column":66}},"123":{"start":{"line":467,"column":16},"end":{"line":467,"column":38}},"124":{"start":{"line":468,"column":16},"end":{"line":468,"column":70}},"125":{"start":{"line":469,"column":16},"end":{"line":469,"column":37}}},"branchMap":{"1":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":16},"end":{"line":82,"column":16}},{"start":{"line":82,"column":16},"end":{"line":82,"column":16}}]},"2":{"line":82,"type":"binary-expr","locations":[{"start":{"line":82,"column":20},"end":{"line":82,"column":64}},{"start":{"line":82,"column":68},"end":{"line":82,"column":97}}]},"3":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":16},"end":{"line":116,"column":16}},{"start":{"line":116,"column":16},"end":{"line":116,"column":16}}]},"4":{"line":156,"type":"binary-expr","locations":[{"start":{"line":156,"column":43},"end":{"line":156,"column":55}},{"start":{"line":156,"column":59},"end":{"line":156,"column":76}},{"start":{"line":156,"column":80},"end":{"line":156,"column":112}}]},"5":{"line":158,"type":"if","locations":[{"start":{"line":158,"column":16},"end":{"line":158,"column":16}},{"start":{"line":158,"column":16},"end":{"line":158,"column":16}}]},"6":{"line":160,"type":"cond-expr","locations":[{"start":{"line":160,"column":70},"end":{"line":160,"column":73}},{"start":{"line":160,"column":76},"end":{"line":160,"column":92}}]},"7":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":24},"end":{"line":175,"column":24}},{"start":{"line":175,"column":24},"end":{"line":175,"column":24}}]},"8":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":24},"end":{"line":208,"column":24}},{"start":{"line":208,"column":24},"end":{"line":208,"column":24}}]},"9":{"line":209,"type":"if","locations":[{"start":{"line":209,"column":28},"end":{"line":209,"column":28}},{"start":{"line":209,"column":28},"end":{"line":209,"column":28}}]},"10":{"line":211,"type":"if","locations":[{"start":{"line":211,"column":32},"end":{"line":211,"column":32}},{"start":{"line":211,"column":32},"end":{"line":211,"column":32}}]},"11":{"line":212,"type":"if","locations":[{"start":{"line":212,"column":36},"end":{"line":212,"column":36}},{"start":{"line":212,"column":36},"end":{"line":212,"column":36}}]},"12":{"line":213,"type":"if","locations":[{"start":{"line":213,"column":40},"end":{"line":213,"column":40}},{"start":{"line":213,"column":40},"end":{"line":213,"column":40}}]},"13":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":36},"end":{"line":220,"column":36}},{"start":{"line":220,"column":36},"end":{"line":220,"column":36}}]},"14":{"line":220,"type":"binary-expr","locations":[{"start":{"line":220,"column":40},"end":{"line":220,"column":52}},{"start":{"line":220,"column":56},"end":{"line":220,"column":85}}]},"15":{"line":233,"type":"if","locations":[{"start":{"line":233,"column":36},"end":{"line":233,"column":36}},{"start":{"line":233,"column":36},"end":{"line":233,"column":36}}]},"16":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":32},"end":{"line":244,"column":32}},{"start":{"line":244,"column":32},"end":{"line":244,"column":32}}]},"17":{"line":280,"type":"if","locations":[{"start":{"line":280,"column":16},"end":{"line":280,"column":16}},{"start":{"line":280,"column":16},"end":{"line":280,"column":16}}]},"18":{"line":284,"type":"if","locations":[{"start":{"line":284,"column":16},"end":{"line":284,"column":16}},{"start":{"line":284,"column":16},"end":{"line":284,"column":16}}]},"19":{"line":284,"type":"binary-expr","locations":[{"start":{"line":284,"column":20},"end":{"line":284,"column":26}},{"start":{"line":284,"column":30},"end":{"line":284,"column":43}}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":20},"end":{"line":288,"column":20}},{"start":{"line":288,"column":20},"end":{"line":288,"column":20}}]},"21":{"line":292,"type":"if","locations":[{"start":{"line":292,"column":20},"end":{"line":292,"column":20}},{"start":{"line":292,"column":20},"end":{"line":292,"column":20}}]},"22":{"line":296,"type":"if","locations":[{"start":{"line":296,"column":20},"end":{"line":296,"column":20}},{"start":{"line":296,"column":20},"end":{"line":296,"column":20}}]},"23":{"line":299,"type":"if","locations":[{"start":{"line":299,"column":20},"end":{"line":299,"column":20}},{"start":{"line":299,"column":20},"end":{"line":299,"column":20}}]},"24":{"line":304,"type":"binary-expr","locations":[{"start":{"line":304,"column":37},"end":{"line":304,"column":76}},{"start":{"line":304,"column":80},"end":{"line":304,"column":82}}]},"25":{"line":340,"type":"if","locations":[{"start":{"line":340,"column":20},"end":{"line":340,"column":20}},{"start":{"line":340,"column":20},"end":{"line":340,"column":20}}]},"26":{"line":438,"type":"if","locations":[{"start":{"line":438,"column":20},"end":{"line":438,"column":20}},{"start":{"line":438,"column":20},"end":{"line":438,"column":20}}]}},"code":["(function () { YUI.add('moodle-atto_circuit-button', function (Y, NAME) {","","","","// This file is part of Moodle - http://moodle.org/","//","// Moodle is free software: you can redistribute it and/or modify","// it under the terms of the GNU General Public License as published by","// the Free Software Foundation; either version 3 of the License; or","// (at your option) any later version.","//","// Moodle is distributed in the hope that it will be useful;","// but WITHOUT ANY WARRANTY; without even the implied warranty of","// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the","// GNU General Public License for more details.","//","// You should have received a copy of the GNU General Public License","// along with Moodle.  If not; see <http://www.gnu.org/licenses/>.","","/**"," * Strings for component 'atto_circuit'; language 'en'."," *"," * @package    atto_circuit"," * @copyright (C) 2011 Massachusetts Institute of Technology"," * @copyright (C) 2015-2019 Modifications by Khan Academy and Willy McAllister, Spinning Numbers."," * @copyright (C) 2021 Adapations for Moodle, RECITFAD https://recitfad.ca ."," * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */","    ","    /**","     * @module moodle-atto_circuit-button","     */","    ","    /**","     * Atto text editor circuit plugin.","     *","     * @namespace M.atto_circuit","     * @class button","     * @extends M.editor_atto.EditorPlugin","     */","    ","    var COMPONENTNAME = 'atto_circuit',","        ATTRSTOREINREPO = 'storeinrepo',","        REGEX = {","            ISPERCENT: /\\d+%/","        },","        IFSOURCE = M.cfg.wwwroot + '/lib/editor/atto/plugins/circuit/circuit.html',","        IFID = 'circuitpad',","        SUBMITID = 'submit',","        CSS = {","            INPUTSUBMIT: 'atto_circuit_submit',","            HGT: 'height: 600px;',","            WDT: 'width: 975px;'","        },","        TEMPLATE = '' +","                '<iframe src=\"{{isource}}\" id=\"{{iframeID}}\" style=\"{{CSS.HGT}}{{CSS.WDT}}\" scrolling=\"auto\" frameborder=\"0\">' +","                '</iframe>' +","                '<div style=\"text-align:center\">' +","                    '<button class=\"mdl-align btn btn-primary {{CSS.INPUTSUBMIT}}\" id=\"{{submitid}}\" style=\"{{selectalign}}\">' +","                        '{{get_string \"insert\" component}}' +","                    '</button>' +","                '</div>',","        IMAGETEMPLATE = '' +","                    '<img src=\"{{url}}\" alt=\"{{alt}}\" ' +","                        '{{#if width}}width=\"{{width}}\" {{/if}}' +","                        '{{#if height}}height=\"{{height}}\" {{/if}}' +","                        '{{#if presentation}}role=\"presentation\" {{/if}}' +","                        '{{#if customstyle}}style=\"{{customstyle}}\" {{/if}}' +","                        '{{#if classlist}}class=\"{{classlist}}\" {{/if}}' +","                        '{{#if id}}id=\"{{id}}\" {{/if}}' +","                    '/>',","        myLC = null;","    ","        Y.namespace('M.atto_circuit').Button = Y.Base.create('button', Y.M.editor_atto.EditorPlugin, [], {","            /**","             * Initialize the button","             *","             * @method Initializer","             */","            initializer: function() {","                // Filepicker must be enabled to work.","                if (!this.get('host').canShowFilepicker('media') && this.get(ATTRSTOREINREPO) > 0) {","                    return;","                }","    ","                // Set name of button icon to be loaded.","                //var icon = 'iconone';","                //if ($allowed == true) {","                    this.addButton({","                        icon: 'circuit',","                        iconComponent: 'atto_circuit',","                        buttonName: \"Circtuit\",","                        callback: this._displayDialogue,","                        //buttonadded = true","                        //callbackArgs: icon,","                        //tags: 'img',","                        //tagMatchRequiresAll: false","                    });","                //}","            },","    ","            /**","             * Converts base64 to binary.","             *","             * @method _convertImage","             * @param {string} dataURI","             * @return {Blob} Binary object.","             * @private","             */","            _convertImage: function(dataURI) {","                // convert base64/URLEncoded data component to raw binary data held in a string","                var byteString;","                //var canvas = document.getElementById(\"canvas\");","\t\t\t\t","                //byteString = canvas.toDataURL();","                if (dataURI.split(',')[0].indexOf('base64') >= 0) {","                    byteString = atob(dataURI.split(',')[1]);","                } else {","                    byteString = decodeURI(dataURI.split(',')[1]);","                }","                // separate out the mime component","                var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];","    ","                // write the bytes of the string to a typed array","                var ia = new Uint8Array(byteString.length);","                for (var i = 0; i < byteString.length; i++) {","                    ia[i] = byteString.charCodeAt(i);","                }","    ","                return new Blob([ia], {type: mimeString});","            },","    ","            /**","             * Handle an image to repo.","             *","             * @method _doInsert","             * @param {EventFacade} e","             * @return {object}","             * @private","             */","            _doInsert: function(e) {","                console.log(\"go1\");","                var self = this,","                    host = this.get('host'),","                    template = Y.Handlebars.compile(IMAGETEMPLATE);","    ","                host.saveSelection();","                e = e._event;","                var canvas = document.getElementById(IFID).contentWindow.document.getElementById(\"canvas\");","\t\t\t\t\t\t\t\t","                //var circuitimage = canvas.toDataURL();","                //var circuitimage = self._convertImage(myLC.getImage().toDataURL());","                var circuitimage = self._convertImage(canvas.toDataURL());","                console.log(circuitimage);","                // Only handle the event if an image file was dropped in.","                var handlesDataTransfer = (circuitimage && circuitimage.size && circuitimage.type == 'image/png');","                console.log(handlesDataTransfer);","                if (handlesDataTransfer) {","                    var options = host.get('filepickeroptions').image,","                        savepath = (options.savepath === undefined) ? '/' : options.savepath,","                        formData = new FormData(),","                        timestamp = 0,","                        uploadid = \"\",","                        xhr = new XMLHttpRequest(),","                        imagehtml = \"\",","                        keys = Object.keys(options.repositories);","    ","                    e.preventDefault();","                    e.stopPropagation();","                    formData.append('repo_upload_file', circuitimage);","                    formData.append('itemid', options.itemid);","    ","                    // List of repositories is an object rather than an array.  This makes iteration more awkward.","                    for (var i = 0; i < keys.length; i++) {","                        if (options.repositories[keys[i]].type === 'upload') {","                            formData.append('repo_id', options.repositories[keys[i]].id);","                            break;","                        }","                    }","                    formData.append('env', options.env);","                    formData.append('sesskey', M.cfg.sesskey);","                    formData.append('client_id', options.client_id);","                    formData.append('savepath', savepath);","                    formData.append('ctx_id', options.context.id);","    ","                    // Insert spinner as a placeholder.","                    timestamp = new Date().getTime();","                    uploadid = 'moodleimage_' + Math.round(Math.random() * 100000) + '-' + timestamp;","                    self.getDialogue({focusAfterHide: null}).hide();","                    host.focus();","                    host.restoreSelection();","                    imagehtml = template({","                        url: M.util.image_url(\"i/loading_small\", 'moodle'),","                        alt: M.util.get_string('uploading', COMPONENTNAME),","                        id: uploadid","                    });","                    host.insertContentAtFocusPoint(imagehtml);","                    self.markUpdated();","    ","                    // Kick off a XMLHttpRequest.","                    xhr.onreadystatechange = function() {","                        var placeholder = self.editor.one('#' + uploadid),","                            result,","                            file,","                            newhtml,","                            newimage;","    ","                        if (xhr.readyState === 4) {","                            if (xhr.status === 200) {","                                result = JSON.parse(xhr.responseText);","                                if (result) {","                                    if (result.error) {","                                        if (placeholder) {","                                            placeholder.remove(true);","                                        }","                                        return new M.core.ajaxException(result);","                                    }","    ","                                    file = result;","                                    if (result.event && result.event === 'fileexists') {","                                        // A file with this name is already in use here - rename to avoid conflict.","                                        // Chances are, it's a different image (stored in a different folder on the user's computer).","                                        // If the user wants to reuse an existing image, they can copy/paste it within the editor.","                                        file = result.newfile;","                                    }","    ","                                    // Replace placeholder with actual image.","                                    newhtml = template({","                                        url: file.url,","                                        presentation: true","                                    });","                                    newimage = Y.Node.create(newhtml);","                                    if (placeholder) {","                                        placeholder.replace(newimage);","                                    } else {","                                        self.editor.appendChild(newimage);","                                    }","                                    self.markUpdated();","                                }","                            } else {","                                Y.use('moodle-core-notification-alert', function() {","                                    new M.core.alert({message: M.util.get_string('servererror', 'moodle')});","                                });","                                if (placeholder) {","                                    placeholder.remove(true);","                                }","                            }","                        }","                        return true;","                    };","                    xhr.open(\"POST\", M.cfg.wwwroot + '/repository/repository_ajax.php?action=upload', true);","                    xhr.send(formData);","                    return true;","                }","                return true;","            },","    ","            /**","             * Gets the properties of the currently selected image.","             *","             * The first image only if multiple images are selected.","             *","             * @method _getSelectedImageProperties","             * @return {object}","             * @private","             */","            _getSelectedImageProperties: function() {","                var properties = {","                    src: null,","                    alt: null,","                    width: null,","                    height: null","                },","    ","                // Get the current selection.","                images = this.get('host').getSelectedNodes(),","                width,","                height;","    ","                if (images) {","                    images = images.filter('img');","                }","    ","                if (images && images.size()) {","                    this._selectedImage = images.item(0);","    ","                    width = this._selectedImage.getAttribute('width');","                    if (!width.match(REGEX.ISPERCENT)) {","                        width = parseInt(width, 10);","                    }","                    height = this._selectedImage.getAttribute('height');","                    if (!height.match(REGEX.ISPERCENT)) {","                        height = parseInt(height, 10);","                    }","    ","                    if (width !== 0) {","                        properties.width = width;","                    }","                    if (height !== 0) {","                        properties.height = height;","                    }","    ","                    properties.src = this._selectedImage.getAttribute('src');","                    properties.alt = this._selectedImage.getAttribute('alt') || '';","                    return properties;","                }","    ","                // No image selected - clean up.","                this._selectedImage = null;","                return false;","            },","    ","            /**","             * Display the panoptobutton Dialogue","             *","             * @method _displayDialogue","             * @param {EventFacade} e","             * @param {object} clickedicon","             * @private","             */","            _displayDialogue: function(e, clickedicon) {","                var width = 'auto',","                    height = 'auto',","                    bodycontent,","                    dialogue;","    ","                dialogue = this.getDialogue({","                    headerContent: M.util.get_string('circuittitle', COMPONENTNAME),","                    width: width,","                    height: height,","                    focusAfterHide: clickedicon","                });","    ","                e.preventDefault();","    ","                // When dialog becomes invisible, reset it. This fixes problems with multiple editors per page.","                dialogue.after('visibleChange', function() {","                    var attributes = dialogue.getAttrs();","    ","                    if (attributes.visible === false) {","                        setTimeout(function() {","                            dialogue.reset();","                        }, 5);","                    }","                });","","                // Append buttons to iframe.","                bodycontent = this._getFormContent(clickedicon);","    ","                // Set to bodycontent.","                dialogue.set('bodyContent', bodycontent);","    ","                document.getElementById(IFID).src = IFSOURCE;","                dialogue.centerDialogue();","                dialogue.show();","                this.markUpdated();","    ","                /*var selected = false;","                if (this.get('host').getSelection() !== false) {","                    selected = this._getSelectedImageProperties();","                }","                document.getElementById(IFID).addEventListener(\"load\", function() {","                    var circuitpad =  document.getElementById(IFID).contentDocument.getElementsById('canvas');","                    var iframe = document.getElementById(IFID).contentWindow;","                    myLC = iframe.LC.init(circuitpad,","                           {","                                imageURLPrefix: 'assets/img',","                                tools: iframe.LC.defaultTools.concat([iframe.regularShapes])","                           });","    ","                    if (selected) { // Selection is an image.","                        var newImage = new Image();","                        newImage.src = selected.src;","                        var newShape = iframe.LC.createShape('Image',","                                       {","                                            x: 10,","                                            y: 10,","                                            image: newImage","                                       });","                        myLC.saveShape(newShape);","                    }","    ","                    // IE 11 and under do not understand CSS3 height calc().","                    if (navigator.userAgent.indexOf('MSIE') !== -1","                        || navigator.appVersion.indexOf('Trident/') > 0) {","                        var ieheight = document.documentElement.clientHeight;","                        if (Y.one('.moodle-dialogue-focused')) {","                            Y.one('.moodle-dialogue-focused').setStyle('height', ieheight + 'px');","                        }","                        if (Y.one('.moodle-dialogue-focused .moodle-dialogue-bd')) {","                            Y.one('.moodle-dialogue-focused .moodle-dialogue-bd').setStyle('height', ieheight - 50 + 'px');","                        }","                    }","    ","                    // Set top and left to corner and calculate height with CSS3.","                    if (Y.one('.moodle-dialogue-focused')) {","                        Y.one('.moodle-dialogue-focused').setStyle('position', 'fixed');","                        Y.one('.moodle-dialogue-focused').setStyle('z-index', '9999');","                        Y.one('.moodle-dialogue-focused').setStyle('top', '0');","                        Y.one('.moodle-dialogue-focused').setStyle('left', '0');","                    }","                    if (Y.one('.moodle-dialogue-focused .moodle-dialogue-bd')) {","                        Y.one('.moodle-dialogue-focused .moodle-dialogue-bd').setStyle('height', 'calc(100% - 50px)');","                        Y.one('.moodle-dialogue-focused .moodle-dialogue-bd').setStyle('padding', '0');","                    }","                    if (Y.one('.moodle-dialogue-focused').ancestor('.moodle-dialogue-base')) {","                        Y.one('.moodle-dialogue-focused').ancestor('.moodle-dialogue-base').setStyle('bottom', \"0\");","                    }","                    if (Y.one('.moodle-dialogue-focused').ancestor('.moodle-dialogue-fullscreen')) {","                        Y.one('.moodle-dialogue-focused').ancestor('.moodle-dialogue-fullscreen').setStyle('bottom', \"0\");","                    }","                });*/","            },","    ","            /**","             * Return the dialogue content for the tool, attaching any required","             * events.","             *","             * @method _getFormContent","             * @param {object} clickedicon","             * @return {Node} The content to place in the dialogue.","             * @private","             */","            _getFormContent: function(clickedicon) {","                var template = Y.Handlebars.compile(TEMPLATE),","                    content = Y.Node.create(template({","                        elementid: this.get('host').get('elementid'),","                        CSS: CSS,","                        component: COMPONENTNAME,","                        clickedicon: clickedicon,","                        isource: IFSOURCE,","                        iframeID: IFID,","                        submitid: SUBMITID","                    }));","    ","                    this._form = content;","                    // Check setting.","                    if (this.get(ATTRSTOREINREPO) > 0) {","                        this._form.one('.' + CSS.INPUTSUBMIT).on('click', this._doInsert, this);","                        console.log(\"doinsert\");","                    } else {","                        this._form.one('.' + CSS.INPUTSUBMIT).on('click', this._doInsertBase64, this);","                    }","    ","                    return content;","            },","    ","            /**","             * Inserts the users input onto the page","             * @method _doInsertBase64","             * @param {EventFacade} e","             * @private","             */","            _doInsertBase64: function(e) {","                e.preventDefault();","                var parent = this;","                var canvas = document.getElementById(IFID).contentWindow.document.getElementById(\"canvas\");","\t\t\t\timgstring = canvas.toDataURL();","\t\t\t  //var image = canvas.toDataURL();","                    //imgstring = myLC.getImage().toDataURL();","                    circuit = '<img src=\"' + imgstring + '\" />';","    ","                // Hide the pop-up after we've received the selection in the \"deliveryList\" message.","                // Hiding before message is received causes exceptions in IE.","                parent.getDialogue({focusAfterHide: null}).hide();","    ","                parent.editor.focus();","                parent.get('host').insertContentAtFocusPoint(circuit);","                parent.markUpdated();","            }","        }, {","        ATTRS: {","            /**","             * How to save circuites.","             *","             * @attribute storeinrepo","             * @type Number","             * @default 0","             */","            storeinrepo: {","                value: 0","            }","        }});","    ","    ","    ","","}, '@VERSION@', {\"requires\": [\"moodle-editor_atto-plugin\"]});","","}());"]};
}
__cov_RLVARTH7R3hs16JuZi1usA = __cov_RLVARTH7R3hs16JuZi1usA['build/moodle-atto_circuit-button/moodle-atto_circuit-button.js'];
__cov_RLVARTH7R3hs16JuZi1usA.s['1']++;YUI.add('moodle-atto_circuit-button',function(Y,NAME){__cov_RLVARTH7R3hs16JuZi1usA.f['1']++;__cov_RLVARTH7R3hs16JuZi1usA.s['2']++;var COMPONENTNAME='atto_circuit',ATTRSTOREINREPO='storeinrepo',REGEX={ISPERCENT:/\d+%/},IFSOURCE=M.cfg.wwwroot+'/lib/editor/atto/plugins/circuit/circuit.html',IFID='circuitpad',SUBMITID='submit',CSS={INPUTSUBMIT:'atto_circuit_submit',HGT:'height: 600px;',WDT:'width: 975px;'},TEMPLATE=''+'<iframe src="{{isource}}" id="{{iframeID}}" style="{{CSS.HGT}}{{CSS.WDT}}" scrolling="auto" frameborder="0">'+'</iframe>'+'<div style="text-align:center">'+'<button class="mdl-align btn btn-primary {{CSS.INPUTSUBMIT}}" id="{{submitid}}" style="{{selectalign}}">'+'{{get_string "insert" component}}'+'</button>'+'</div>',IMAGETEMPLATE=''+'<img src="{{url}}" alt="{{alt}}" '+'{{#if width}}width="{{width}}" {{/if}}'+'{{#if height}}height="{{height}}" {{/if}}'+'{{#if presentation}}role="presentation" {{/if}}'+'{{#if customstyle}}style="{{customstyle}}" {{/if}}'+'{{#if classlist}}class="{{classlist}}" {{/if}}'+'{{#if id}}id="{{id}}" {{/if}}'+'/>',myLC=null;__cov_RLVARTH7R3hs16JuZi1usA.s['3']++;Y.namespace('M.atto_circuit').Button=Y.Base.create('button',Y.M.editor_atto.EditorPlugin,[],{initializer:function(){__cov_RLVARTH7R3hs16JuZi1usA.f['2']++;__cov_RLVARTH7R3hs16JuZi1usA.s['4']++;if((__cov_RLVARTH7R3hs16JuZi1usA.b['2'][0]++,!this.get('host').canShowFilepicker('media'))&&(__cov_RLVARTH7R3hs16JuZi1usA.b['2'][1]++,this.get(ATTRSTOREINREPO)>0)){__cov_RLVARTH7R3hs16JuZi1usA.b['1'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['5']++;return;}else{__cov_RLVARTH7R3hs16JuZi1usA.b['1'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['6']++;this.addButton({icon:'circuit',iconComponent:'atto_circuit',buttonName:'Circtuit',callback:this._displayDialogue});},_convertImage:function(dataURI){__cov_RLVARTH7R3hs16JuZi1usA.f['3']++;__cov_RLVARTH7R3hs16JuZi1usA.s['7']++;var byteString;__cov_RLVARTH7R3hs16JuZi1usA.s['8']++;if(dataURI.split(',')[0].indexOf('base64')>=0){__cov_RLVARTH7R3hs16JuZi1usA.b['3'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['9']++;byteString=atob(dataURI.split(',')[1]);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['3'][1]++;__cov_RLVARTH7R3hs16JuZi1usA.s['10']++;byteString=decodeURI(dataURI.split(',')[1]);}__cov_RLVARTH7R3hs16JuZi1usA.s['11']++;var mimeString=dataURI.split(',')[0].split(':')[1].split(';')[0];__cov_RLVARTH7R3hs16JuZi1usA.s['12']++;var ia=new Uint8Array(byteString.length);__cov_RLVARTH7R3hs16JuZi1usA.s['13']++;for(var i=0;i<byteString.length;i++){__cov_RLVARTH7R3hs16JuZi1usA.s['14']++;ia[i]=byteString.charCodeAt(i);}__cov_RLVARTH7R3hs16JuZi1usA.s['15']++;return new Blob([ia],{type:mimeString});},_doInsert:function(e){__cov_RLVARTH7R3hs16JuZi1usA.f['4']++;__cov_RLVARTH7R3hs16JuZi1usA.s['16']++;console.log('go1');__cov_RLVARTH7R3hs16JuZi1usA.s['17']++;var self=this,host=this.get('host'),template=Y.Handlebars.compile(IMAGETEMPLATE);__cov_RLVARTH7R3hs16JuZi1usA.s['18']++;host.saveSelection();__cov_RLVARTH7R3hs16JuZi1usA.s['19']++;e=e._event;__cov_RLVARTH7R3hs16JuZi1usA.s['20']++;var canvas=document.getElementById(IFID).contentWindow.document.getElementById('canvas');__cov_RLVARTH7R3hs16JuZi1usA.s['21']++;var circuitimage=self._convertImage(canvas.toDataURL());__cov_RLVARTH7R3hs16JuZi1usA.s['22']++;console.log(circuitimage);__cov_RLVARTH7R3hs16JuZi1usA.s['23']++;var handlesDataTransfer=(__cov_RLVARTH7R3hs16JuZi1usA.b['4'][0]++,circuitimage)&&(__cov_RLVARTH7R3hs16JuZi1usA.b['4'][1]++,circuitimage.size)&&(__cov_RLVARTH7R3hs16JuZi1usA.b['4'][2]++,circuitimage.type=='image/png');__cov_RLVARTH7R3hs16JuZi1usA.s['24']++;console.log(handlesDataTransfer);__cov_RLVARTH7R3hs16JuZi1usA.s['25']++;if(handlesDataTransfer){__cov_RLVARTH7R3hs16JuZi1usA.b['5'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['26']++;var options=host.get('filepickeroptions').image,savepath=options.savepath===undefined?(__cov_RLVARTH7R3hs16JuZi1usA.b['6'][0]++,'/'):(__cov_RLVARTH7R3hs16JuZi1usA.b['6'][1]++,options.savepath),formData=new FormData(),timestamp=0,uploadid='',xhr=new XMLHttpRequest(),imagehtml='',keys=Object.keys(options.repositories);__cov_RLVARTH7R3hs16JuZi1usA.s['27']++;e.preventDefault();__cov_RLVARTH7R3hs16JuZi1usA.s['28']++;e.stopPropagation();__cov_RLVARTH7R3hs16JuZi1usA.s['29']++;formData.append('repo_upload_file',circuitimage);__cov_RLVARTH7R3hs16JuZi1usA.s['30']++;formData.append('itemid',options.itemid);__cov_RLVARTH7R3hs16JuZi1usA.s['31']++;for(var i=0;i<keys.length;i++){__cov_RLVARTH7R3hs16JuZi1usA.s['32']++;if(options.repositories[keys[i]].type==='upload'){__cov_RLVARTH7R3hs16JuZi1usA.b['7'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['33']++;formData.append('repo_id',options.repositories[keys[i]].id);__cov_RLVARTH7R3hs16JuZi1usA.s['34']++;break;}else{__cov_RLVARTH7R3hs16JuZi1usA.b['7'][1]++;}}__cov_RLVARTH7R3hs16JuZi1usA.s['35']++;formData.append('env',options.env);__cov_RLVARTH7R3hs16JuZi1usA.s['36']++;formData.append('sesskey',M.cfg.sesskey);__cov_RLVARTH7R3hs16JuZi1usA.s['37']++;formData.append('client_id',options.client_id);__cov_RLVARTH7R3hs16JuZi1usA.s['38']++;formData.append('savepath',savepath);__cov_RLVARTH7R3hs16JuZi1usA.s['39']++;formData.append('ctx_id',options.context.id);__cov_RLVARTH7R3hs16JuZi1usA.s['40']++;timestamp=new Date().getTime();__cov_RLVARTH7R3hs16JuZi1usA.s['41']++;uploadid='moodleimage_'+Math.round(Math.random()*100000)+'-'+timestamp;__cov_RLVARTH7R3hs16JuZi1usA.s['42']++;self.getDialogue({focusAfterHide:null}).hide();__cov_RLVARTH7R3hs16JuZi1usA.s['43']++;host.focus();__cov_RLVARTH7R3hs16JuZi1usA.s['44']++;host.restoreSelection();__cov_RLVARTH7R3hs16JuZi1usA.s['45']++;imagehtml=template({url:M.util.image_url('i/loading_small','moodle'),alt:M.util.get_string('uploading',COMPONENTNAME),id:uploadid});__cov_RLVARTH7R3hs16JuZi1usA.s['46']++;host.insertContentAtFocusPoint(imagehtml);__cov_RLVARTH7R3hs16JuZi1usA.s['47']++;self.markUpdated();__cov_RLVARTH7R3hs16JuZi1usA.s['48']++;xhr.onreadystatechange=function(){__cov_RLVARTH7R3hs16JuZi1usA.f['5']++;__cov_RLVARTH7R3hs16JuZi1usA.s['49']++;var placeholder=self.editor.one('#'+uploadid),result,file,newhtml,newimage;__cov_RLVARTH7R3hs16JuZi1usA.s['50']++;if(xhr.readyState===4){__cov_RLVARTH7R3hs16JuZi1usA.b['8'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['51']++;if(xhr.status===200){__cov_RLVARTH7R3hs16JuZi1usA.b['9'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['52']++;result=JSON.parse(xhr.responseText);__cov_RLVARTH7R3hs16JuZi1usA.s['53']++;if(result){__cov_RLVARTH7R3hs16JuZi1usA.b['10'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['54']++;if(result.error){__cov_RLVARTH7R3hs16JuZi1usA.b['11'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['55']++;if(placeholder){__cov_RLVARTH7R3hs16JuZi1usA.b['12'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['56']++;placeholder.remove(true);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['12'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['57']++;return new M.core.ajaxException(result);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['11'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['58']++;file=result;__cov_RLVARTH7R3hs16JuZi1usA.s['59']++;if((__cov_RLVARTH7R3hs16JuZi1usA.b['14'][0]++,result.event)&&(__cov_RLVARTH7R3hs16JuZi1usA.b['14'][1]++,result.event==='fileexists')){__cov_RLVARTH7R3hs16JuZi1usA.b['13'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['60']++;file=result.newfile;}else{__cov_RLVARTH7R3hs16JuZi1usA.b['13'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['61']++;newhtml=template({url:file.url,presentation:true});__cov_RLVARTH7R3hs16JuZi1usA.s['62']++;newimage=Y.Node.create(newhtml);__cov_RLVARTH7R3hs16JuZi1usA.s['63']++;if(placeholder){__cov_RLVARTH7R3hs16JuZi1usA.b['15'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['64']++;placeholder.replace(newimage);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['15'][1]++;__cov_RLVARTH7R3hs16JuZi1usA.s['65']++;self.editor.appendChild(newimage);}__cov_RLVARTH7R3hs16JuZi1usA.s['66']++;self.markUpdated();}else{__cov_RLVARTH7R3hs16JuZi1usA.b['10'][1]++;}}else{__cov_RLVARTH7R3hs16JuZi1usA.b['9'][1]++;__cov_RLVARTH7R3hs16JuZi1usA.s['67']++;Y.use('moodle-core-notification-alert',function(){__cov_RLVARTH7R3hs16JuZi1usA.f['6']++;__cov_RLVARTH7R3hs16JuZi1usA.s['68']++;new M.core.alert({message:M.util.get_string('servererror','moodle')});});__cov_RLVARTH7R3hs16JuZi1usA.s['69']++;if(placeholder){__cov_RLVARTH7R3hs16JuZi1usA.b['16'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['70']++;placeholder.remove(true);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['16'][1]++;}}}else{__cov_RLVARTH7R3hs16JuZi1usA.b['8'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['71']++;return true;};__cov_RLVARTH7R3hs16JuZi1usA.s['72']++;xhr.open('POST',M.cfg.wwwroot+'/repository/repository_ajax.php?action=upload',true);__cov_RLVARTH7R3hs16JuZi1usA.s['73']++;xhr.send(formData);__cov_RLVARTH7R3hs16JuZi1usA.s['74']++;return true;}else{__cov_RLVARTH7R3hs16JuZi1usA.b['5'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['75']++;return true;},_getSelectedImageProperties:function(){__cov_RLVARTH7R3hs16JuZi1usA.f['7']++;__cov_RLVARTH7R3hs16JuZi1usA.s['76']++;var properties={src:null,alt:null,width:null,height:null},images=this.get('host').getSelectedNodes(),width,height;__cov_RLVARTH7R3hs16JuZi1usA.s['77']++;if(images){__cov_RLVARTH7R3hs16JuZi1usA.b['17'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['78']++;images=images.filter('img');}else{__cov_RLVARTH7R3hs16JuZi1usA.b['17'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['79']++;if((__cov_RLVARTH7R3hs16JuZi1usA.b['19'][0]++,images)&&(__cov_RLVARTH7R3hs16JuZi1usA.b['19'][1]++,images.size())){__cov_RLVARTH7R3hs16JuZi1usA.b['18'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['80']++;this._selectedImage=images.item(0);__cov_RLVARTH7R3hs16JuZi1usA.s['81']++;width=this._selectedImage.getAttribute('width');__cov_RLVARTH7R3hs16JuZi1usA.s['82']++;if(!width.match(REGEX.ISPERCENT)){__cov_RLVARTH7R3hs16JuZi1usA.b['20'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['83']++;width=parseInt(width,10);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['20'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['84']++;height=this._selectedImage.getAttribute('height');__cov_RLVARTH7R3hs16JuZi1usA.s['85']++;if(!height.match(REGEX.ISPERCENT)){__cov_RLVARTH7R3hs16JuZi1usA.b['21'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['86']++;height=parseInt(height,10);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['21'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['87']++;if(width!==0){__cov_RLVARTH7R3hs16JuZi1usA.b['22'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['88']++;properties.width=width;}else{__cov_RLVARTH7R3hs16JuZi1usA.b['22'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['89']++;if(height!==0){__cov_RLVARTH7R3hs16JuZi1usA.b['23'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['90']++;properties.height=height;}else{__cov_RLVARTH7R3hs16JuZi1usA.b['23'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['91']++;properties.src=this._selectedImage.getAttribute('src');__cov_RLVARTH7R3hs16JuZi1usA.s['92']++;properties.alt=(__cov_RLVARTH7R3hs16JuZi1usA.b['24'][0]++,this._selectedImage.getAttribute('alt'))||(__cov_RLVARTH7R3hs16JuZi1usA.b['24'][1]++,'');__cov_RLVARTH7R3hs16JuZi1usA.s['93']++;return properties;}else{__cov_RLVARTH7R3hs16JuZi1usA.b['18'][1]++;}__cov_RLVARTH7R3hs16JuZi1usA.s['94']++;this._selectedImage=null;__cov_RLVARTH7R3hs16JuZi1usA.s['95']++;return false;},_displayDialogue:function(e,clickedicon){__cov_RLVARTH7R3hs16JuZi1usA.f['8']++;__cov_RLVARTH7R3hs16JuZi1usA.s['96']++;var width='auto',height='auto',bodycontent,dialogue;__cov_RLVARTH7R3hs16JuZi1usA.s['97']++;dialogue=this.getDialogue({headerContent:M.util.get_string('circuittitle',COMPONENTNAME),width:width,height:height,focusAfterHide:clickedicon});__cov_RLVARTH7R3hs16JuZi1usA.s['98']++;e.preventDefault();__cov_RLVARTH7R3hs16JuZi1usA.s['99']++;dialogue.after('visibleChange',function(){__cov_RLVARTH7R3hs16JuZi1usA.f['9']++;__cov_RLVARTH7R3hs16JuZi1usA.s['100']++;var attributes=dialogue.getAttrs();__cov_RLVARTH7R3hs16JuZi1usA.s['101']++;if(attributes.visible===false){__cov_RLVARTH7R3hs16JuZi1usA.b['25'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['102']++;setTimeout(function(){__cov_RLVARTH7R3hs16JuZi1usA.f['10']++;__cov_RLVARTH7R3hs16JuZi1usA.s['103']++;dialogue.reset();},5);}else{__cov_RLVARTH7R3hs16JuZi1usA.b['25'][1]++;}});__cov_RLVARTH7R3hs16JuZi1usA.s['104']++;bodycontent=this._getFormContent(clickedicon);__cov_RLVARTH7R3hs16JuZi1usA.s['105']++;dialogue.set('bodyContent',bodycontent);__cov_RLVARTH7R3hs16JuZi1usA.s['106']++;document.getElementById(IFID).src=IFSOURCE;__cov_RLVARTH7R3hs16JuZi1usA.s['107']++;dialogue.centerDialogue();__cov_RLVARTH7R3hs16JuZi1usA.s['108']++;dialogue.show();__cov_RLVARTH7R3hs16JuZi1usA.s['109']++;this.markUpdated();},_getFormContent:function(clickedicon){__cov_RLVARTH7R3hs16JuZi1usA.f['11']++;__cov_RLVARTH7R3hs16JuZi1usA.s['110']++;var template=Y.Handlebars.compile(TEMPLATE),content=Y.Node.create(template({elementid:this.get('host').get('elementid'),CSS:CSS,component:COMPONENTNAME,clickedicon:clickedicon,isource:IFSOURCE,iframeID:IFID,submitid:SUBMITID}));__cov_RLVARTH7R3hs16JuZi1usA.s['111']++;this._form=content;__cov_RLVARTH7R3hs16JuZi1usA.s['112']++;if(this.get(ATTRSTOREINREPO)>0){__cov_RLVARTH7R3hs16JuZi1usA.b['26'][0]++;__cov_RLVARTH7R3hs16JuZi1usA.s['113']++;this._form.one('.'+CSS.INPUTSUBMIT).on('click',this._doInsert,this);__cov_RLVARTH7R3hs16JuZi1usA.s['114']++;console.log('doinsert');}else{__cov_RLVARTH7R3hs16JuZi1usA.b['26'][1]++;__cov_RLVARTH7R3hs16JuZi1usA.s['115']++;this._form.one('.'+CSS.INPUTSUBMIT).on('click',this._doInsertBase64,this);}__cov_RLVARTH7R3hs16JuZi1usA.s['116']++;return content;},_doInsertBase64:function(e){__cov_RLVARTH7R3hs16JuZi1usA.f['12']++;__cov_RLVARTH7R3hs16JuZi1usA.s['117']++;e.preventDefault();__cov_RLVARTH7R3hs16JuZi1usA.s['118']++;var parent=this;__cov_RLVARTH7R3hs16JuZi1usA.s['119']++;var canvas=document.getElementById(IFID).contentWindow.document.getElementById('canvas');__cov_RLVARTH7R3hs16JuZi1usA.s['120']++;imgstring=canvas.toDataURL();__cov_RLVARTH7R3hs16JuZi1usA.s['121']++;circuit='<img src="'+imgstring+'" />';__cov_RLVARTH7R3hs16JuZi1usA.s['122']++;parent.getDialogue({focusAfterHide:null}).hide();__cov_RLVARTH7R3hs16JuZi1usA.s['123']++;parent.editor.focus();__cov_RLVARTH7R3hs16JuZi1usA.s['124']++;parent.get('host').insertContentAtFocusPoint(circuit);__cov_RLVARTH7R3hs16JuZi1usA.s['125']++;parent.markUpdated();}},{ATTRS:{storeinrepo:{value:0}}});},'@VERSION@',{'requires':['moodle-editor_atto-plugin']});
